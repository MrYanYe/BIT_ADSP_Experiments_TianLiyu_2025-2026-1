---
title: Markdown编辑环境搭建
author: wuqx1999
date: 2023年9月21日
# 指定汉字字体，如果缺少中文显示将不正常
CJKmainfont: 方正苏新诗柳楷简体-yolan
   latex 选项
fontsize: 12pt
linkcolor: blue
urlcolor: green
citecolor: cyan
filecolor: magenta
toccolor: red
geometry: margin=0.3in
papersize: A4
documentclass: article

# pandoc设置
output:
   word_document
   # path: 你想保存的路径，默认与.md文档同文件
# 打印背景色
# 保存文件时自动生成
# export_on_save:
#   pandoc: true
---
s








### 总览

模拟使用的真实参数为 μ = 3，σ = 1.9（σ² = 3.61），n 在对数刻度上从 2 到 1000 取约 30 个点；关键控制量是每个 n 的重复次数 m，实验用到的 m 取值从 1e1 增至 1e6。四个子图分别报告：样本均值的期望、样本均值的方差、样本方差的期望、样本方差的方差。总体结论很直观：随着 m 增大、n 增大，模拟曲线越来越接近理论曲线；当 m 较小或 n 很小时，模拟噪声和有限样本偏差显著。

### 结果与变化趋势（逐图合并描述）

- 样本均值的平均值（E[μ̂]）  
  无论 m 大小，样本均值在 n 增大时围绕真实 μ = 3 波动并收敛。m 越大（重复次数越多），曲线越平滑、波动越小，平均水平越接近 3。原因是样本均值对每次实验的方差为 σ²/n，单次重复的平均会有 O(1/√m) 的 Monte Carlo 误差，所以增大 m 能显著减少观测到的随机波动。

- 样本均值的方差（Var(μ̂)）  
  模拟出的 Var(μ̂) 随 n 增大单调下降，并与理论曲线 σ²/n 非常贴合。对于小 m，模拟值由于 Monte Carlo 噪声偏离理论；随着 m 增大，蓝色曲线趋于红色理论虚线。对于非常小的 n（比如 n≈2、3），波动相对明显，因为样本内变异对估计影响较大。

- 样本方差的平均值（E[σ̂²]）  
  代码中使用 var(X,0,1)（MATLAB 默认无偏估计，即除以 n−1），因此理论期望应等于真实 σ² = 3.61。模拟曲线随 n 增大围绕该真值震荡并收敛到它；m 越大，收敛的波动越小。对极小样本（n 很小）仍能看到较大波动，这是因为方差估计本身方差较大且分布偏厚尾。

- 样本方差的方差（Var(σ̂²)）  
  模拟出的 Var(σ̂²) 随 n 增大快速下降，并与理论公式 2σ^4/(n−1)（正态分布下无偏样本方差的方差）非常一致。对于小 n，理论值较大，模拟方差也高且波动显著；增大 m 后，两条曲线重合得更紧密。若数据不是正态，理论方差需要用含四阶中心距 μ4 的更一般表达式（含 μ4 项）。

### 数学原理的简要解释（不冗长）

- 样本均值 μ̂ 的无偏性与方差：对于来自均值 μ、方差 σ² 的独立同分布样本，E[μ̂] = μ，Var(μ̂) = σ²/n。这里的 Law of Large Numbers 与中心极限定理给出一致性和收敛速率（Var ∝ 1/n，标准误 ∝ 1/√n）。在模拟层面，估计 Var(μ̂) 的 Monte Carlo 误差约为 O(1/√m)。

- 样本方差 s²（无偏，除以 n−1）满足 E[s²] = σ²（正态或一般 IID 下用无偏公式成立），其方差在正态情形下有闭式解 Var(s²) = 2σ^4/(n−1)。更一般的表达式包含四阶中心距 μ4，如果分布偏离正态（肥尾或尖峰），这一项会改变 Var(s²) 的大小与收敛速度。

- Monte Carlo 行为：对每个 n，用 m 次独立重复来逼近估计量的分布；模拟误差随 m 增加按 ≈1/√m 收敛，因此观察到的“噪声”主要由两部分构成：有限 n 导致的估计本身的高方差，以及有限 m 导致的 Monte Carlo 抽样噪声。

### 关键观察与实用建议（简短明确）

- 若目的是验证理论公式（σ²/n 和 2σ^4/(n−1) 等），把 m 提升到至少 1e4–1e5 可以显著减少 Monte Carlo 噪声，使模拟曲线与理论曲线几乎重合。  
- 对于小样本 n（例如 n < 10），样本方差本身方差很大，需要格外小心用置信区间或稳健方法解释结果。  
- 若数据可能偏离正态，应采用包含 μ4 的更一般方差表达式来对比模拟；或直接用自助法（bootstrap）估计 Var(s²)。  
- 代码中使用无偏样本方差（除以 n−1）是解释 E[σ̂²] 与真值一致的关键，若改为除以 n（有偏估计），期望会偏低，理论比较也需相应调整。

总体而言，图像清楚地展示了两个基本事实：估计量对 n 的依赖（收敛速率）由理论刻画良好；而模拟重复次数 m 决定我们能多精确地观测到这种理论行为。

---

### 随机误差与蒙特卡洛收敛速率

模拟中每个样本量 \(n\) 下用 \(m\) 次独立重复来估计量的期望和方差。任何由有限 \(m\) 引入的估计误差属于蒙特卡洛抽样误差，其典型尺度遵循中心极限定理，随重复次数按平方根收敛，量级为 \(O(1/\sqrt{m})\)。因此，当 \(m\) 增大时，所有由模拟得到的曲线都会以约 \(1/\sqrt{m}\) 的速率变得更平滑且更接近真实理论曲线。

---

### 对均值估计量曲线的影响

样本均值的单次试验方差为 \(\operatorname{Var}(\hat{\mu})=\sigma^2/n\)，因此对某个固定 \(n\) 的真实分布，重复 \(m\) 次并取这些重复的样本均值的平均值时观测到的波动包含两部分：单次试验内的变异（大小为 \(\sigma^2/n\)）和由于有限 \(m\) 而产生的 Monte Carlo 估计误差（大小约为 \(\sqrt{\operatorname{Var}(\hat{\mu})/m}=\sigma/\sqrt{n\,m}\)）。结果为：
- 当 \(m\) 较小，观测到的 E[\(\hat{\mu}\)] 曲线有明显噪声，其垂直波动规模约为 \(\sigma/\sqrt{n\,m}\)；
- 随着 \(m\) 增大，该噪声按 \(1/\sqrt{m}\) 缩小，曲线趋近于常数水平 \(\mu\)。

---

### 对方差估计量均值和方差曲线的影响

无偏样本方差 \(\hat{\sigma}^2\) 的无偏性保证 \(E[\hat{\sigma}^2]=\sigma^2\)，但其本身的方差在正态情形下为 \(\operatorname{Var}(\hat{\sigma}^2)=\dfrac{2\sigma^4}{\,n-1\,}\)。对固定 \(n\)，用 \(m\) 次重复估计方差的平均和方差时：
- 平均值的 Monte Carlo 不确定度尺度为 \(\sqrt{\operatorname{Var}(\hat{\sigma}^2)/m}=\sigma^2\sqrt{2/((n-1)m)}\)，所以随着 \(m\) 增大，E[\(\hat{\sigma}^2\)] 的观测曲线波动按 \(1/\sqrt{m}\) 缩小并更精确地位于 \(\sigma^2\) 附近；
- 对于 Var(\(\hat{\sigma}^2\)) 本身的估计，蒙特卡洛误差更大，因为估计方差需要对二阶矩进行估计，其抽样误差通常为常数倍的 \(1/\sqrt{m}\) 并且前因子比均值估计更大，因而在小 \(m\) 时底图右下的绿线波动尤为显著。

---

### 归纳结论与尺度比较

- 统一量纲：对任一估计量 \(T\)（例如 \(\hat{\mu}\) 或 \(\hat{\sigma}^2\)），模拟对其期望或方差的估计不确定度大致为 \(\sqrt{\operatorname{Var}(T)/m}\)。因此改善精度的最直接路径是将 \(m\) 增大，改善幅度按 \(1/\sqrt{m}\) 递减。  
- 与 \(n\) 的交互：因为 \(\operatorname{Var}(\hat{\mu})\) 和 \(\operatorname{Var}(\hat{\sigma}^2)\) 本身随 \(n\) 下降，增加 \(n\) 与增加 \(m\) 都能降低观测噪声，但两者角色不同：\(n\) 改变估计量的固有方差，\(m\) 仅改变我们对该量固有参数的估计精度。  
- 实验设计提示：若目标是验证理论曲线形状和常数项，优先将 \(m\) 提升到能使 Monte Carlo 抖动小于所需精度阈值（常用经验为使 \(1/\sqrt{m}\) 比理论曲线相对误差目标小一到两个数量级）。